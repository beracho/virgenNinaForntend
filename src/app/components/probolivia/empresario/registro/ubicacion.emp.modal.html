<ng-form name="ubicacion_form">
  <div class="modal-header">
    <h5 class="modal-title">
      <img class="cursor-pointer" width="37" height="37"  src="data:image/png;base64,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">
      {{$ctrl.id_ubicacion? 'Editar':'Crear'}} ubicación
    </h5>
    <button type="button" class="close" data-dismiss="modal" ng-click="$ctrl.cancel()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body modal-ubicacion-body">
    <select-municipio departamento="$ctrl.data.fid_departamento" provincia="$ctrl.data.fid_provincia" municipio="$ctrl.data.fid_municipio" conf="$ctrl.conf"></select-municipio>
    <div class="row">
      <div class="col-md-5 form-group" ng-if="$ctrl.conf.zona.visible">
        <label ng-class="{'ap-req':$ctrl.conf.zona.requerido}">{{$ctrl.conf.zona.label}}:</label>
        <input name="zona" class="form-control" ng-model="$ctrl.data.zona" ng-maxlength="100" maxlength="100" ng-required="$ctrl.conf.zona.requerido" ng-disabled="$ctrl.conf.zona.disabled">
        <div ap-error ng-if="$ctrl.data.zona.length>99" role="alert">Superó el límite de los caracteres</div>
        <div ap-error ng-messages="ubicacion_form.zona.$error" role="alert" ng-if="ubicacion_form.zona.$touched">
          <div ng-message="required">El campo es requerido</div>
        </div>
      </div>
      <div class="col-md-5 form-group" ng-if="$ctrl.conf.avenida_calle.visible">
        <label ng-class="{'ap-req':$ctrl.conf.avenida_calle.requerido}">{{$ctrl.conf.avenida_calle.label}}:</label>
        <input name="avenida_calle" class="form-control"  ng-model="$ctrl.data.avenida_calle" ng-maxlength="199" maxlength="200"  ng-required="$ctrl.conf.avenida_calle.requerido" ng-disabled="$ctrl.conf.avenida_calle.disabled">
        <div ap-error ng-if="!ubicacion_form.avenida_calle.$valid" role="alert">Superó el límite de los caracteres</div>
        <div ap-error ng-messages="ubicacion_form.avenida_calle.$error" role="alert" ng-if="ubicacion_form.avenida_calle.$touched">
          <div ng-message="required">El campo es requerido</div>
        </div>
      </div>
      <div class="col-md-2 form-group" ng-if="$ctrl.conf.numero.visible">
        <label ng-class="{'ap-req':$ctrl.conf.numero.requerido}">{{$ctrl.conf.numero.label}}:</label>
        <input name="numero"  maxlength="9" class="form-control" ng-model="$ctrl.data.numero" ng-required="$ctrl.conf.numero.requerido" ng-disabled="$ctrl.conf.numero.disabled">
        <div ap-error ng-messages="ubicacion_form.numero.$error" role="alert" ng-if="ubicacion_form.numero.$touched">
          <div ng-message="required">El campo es requerido</div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-md-5 form-group" ng-if="$ctrl.conf.avenida_calle_referencia.visible">
        <label ng-class="{'ap-req':$ctrl.conf.avenida_calle_referencia.requerido}">{{$ctrl.conf.avenida_calle_referencia.label}}:</label>
        <input name="avenida_calle_referencia" class="form-control" ng-model="$ctrl.data.avenida_calle_referencia" ng-maxlength="199" maxlength="200" ng-required="$ctrl.conf.avenida_calle_referencia.requerido" ng-disabled="$ctrl.conf.avenida_calle_referencia.disabled">
        <div ap-error ng-if="!ubicacion_form.avenida_calle_referencia.$valid" role="alert">Superó el límite de los caracteres</div>
        <div ap-error ng-messages="ubicacion_form.avenida_calle_referencia.$error" role="alert" ng-if="ubicacion_form.avenida_calle_referencia.$touched">
          <div ng-message="required">El campo es requerido</div>
        </div>
      </div>
      <div class="col-md-5 form-group" ng-if="$ctrl.conf.edificio.visible">
        <label ng-class="{'ap-req':$ctrl.conf.edificio.requerido}">{{$ctrl.conf.edificio.label}}:</label>
        <input name="edificio" maxlength="100" class="form-control" ng-model="$ctrl.data.edificio" ng-required="$ctrl.conf.edificio.requerido" ng-disabled="$ctrl.conf.edificio.disabled">
        <div ap-error ng-messages="ubicacion_form.edificio.$error" role="alert" ng-if="ubicacion_form.edificio.$touched">
          <div ng-message="required">El campo es requerido</div>
        </div>
      </div>
      <div class="col-md-2 form-group" ng-if="$ctrl.conf.piso.visible">
        <label ng-class="{'ap-req':$ctrl.conf.piso.requerido}">{{$ctrl.conf.piso.label}}:</label>
        <input name="piso" numeric maxlength="9" class="form-control" ng-model="$ctrl.data.piso" ng-required="$ctrl.conf.piso.requerido" ng-disabled="$ctrl.conf.piso.disabled">
        <div ap-error ng-messages="ubicacion_form.piso.$error" role="alert" ng-if="ubicacion_form.piso.$touched">
          <div ng-message="required">El campo es requerido</div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-md form-group">
        <input-chips name="telefonos" label="{{$ctrl.conf.telefono.label}}:" ng-model="$ctrl.data.telefonos" ng-required="$ctrl.conf.telefono.requerido" before-add="$ctrl.beforeAddTel($chip)" ng-disabled="$ctrl.conf.telefono.disabled">
        </input-chips>
        <div ap-error ng-messages="ubicacion_form.telefonos.$error" role="alert" ng-if="ubicacion_form.telefonos.$touched">
          <div ng-message="required">El campo es requerido</div>
        </div>
      </div>
      <div class="col-md form-group" ng-if="$ctrl.conf.fid_par_territorio_indigena.visible">
        <select-parametro  opcional="true" name="fid_par_territorio_indigena" parametro="TIOC" label="{{$ctrl.conf.fid_par_territorio_indigena.label}}:" ng-model="$ctrl.data.fid_par_territorio_indigena" ng-required="$ctrl.conf.fid_par_territorio_indigena.requerido" ng-disabled="$ctrl.conf.fid_par_territorio_indigena.disabled"></select-parametro>
        <div ap-error ng-messages="ubicacion_form.fid_par_territorio_indigena.$error" role="alert" ng-if="ubicacion_form.fid_par_territorio_indigena.$touched">
          <div ng-message="required">El campo es requerido</div>
        </div>
      </div>
    </div>
    <!-- <leaflet width="100%" height="380px" lf-center="$ctrl.center" markers="$ctrl.markers"></leaflet> -->
    <leaflet width="100%" height="380px" event-broadcast="$ctrl.events_leaflet" lf-center="$ctrl.center" markers="$ctrl.markers" legend = "$ctrl.legend" defaults="defaults" ></leaflet>
  </div>
  <div style="float: left;text-align: left" class="alert alert-{{$ctrl.data.latitud&&$ctrl.data.longitud? 'warning':'info' }} mb-0">
      <i class="fa fa-info-circle" ap></i>
      <span ng-if="$ctrl.data.latitud && $ctrl.data.longitud">Doble clic en el ícono para <strong>eliminar</strong> la ubicación.</span>
      <span ng-if="!($ctrl.data.latitud && $ctrl.data.longitud)">Doble clic en el mapa para <strong>añadir</strong> ubicación.</span>
    </div>
  <div class="modal-footer">



    <button md-effect type="button" class="btn btn-secondary" ng-click="$ctrl.cancel()">
      <i class="fa fa-close"></i> Cerrar
    </button>
    <button md-effect type="button" class="btn btn-primary" ng-click="$ctrl.save(ubicacion_form)">
      <i class="fa fa-check"></i> Guardar
    </button>
  </div>
</ng-form>
